#!/usr/bin/env ruby

require 'yaml'
require 'date'
require 'gmark/lib/bookmark'

files_json = Dir.glob('./**/*.json')
files_text = Dir.glob('./**/*.txt')
files_yaml = Dir.glob('./**/*.yml')

if $0 == __FILE__

  geekmarks = []
  rejectedmarks = []
  
  files_text { |mark_file|
    
    marks = Gmark.parse_google(mark_file)
    
    geekmarks = (geekmarks + marks[0]).uniq { |elem| elem.url }
    rejectedmarks = (rejectedmarks + marks[1]).uniq { |elem| elem }

    geekmarks.each {|elem| puts elem.name}
  }
  
  files_yaml { |mark_file|
    marks = Gmark.parse_google(mark_file)
        
    geekmarks = (geekmarks + marks[0]).uniq { |elem| elem.url }
    rejectedmarks = (rejectedmarks + marks[1]).uniq { |elem| elem }
  }
  
  files_json.each{ |mark_file|
    marks = Gmark.parse_google(mark_file)
    
    geekmarks = (geekmarks + marks[0]).uniq { |elem| elem.url }
    rejectedmarks = (rejectedmarks + marks[1]).uniq { |elem| elem }
  }

  p geekmarks.size
  p rejectedmarks.size

end
